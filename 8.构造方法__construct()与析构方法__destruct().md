# 8.构造方法\_\_construct\(\)与析构方法\_\_destruct\(\)

#### **构造方法：**

大多数类都有一种称为构造函数的特殊方法。当创建一个对象时，它将自动调用构造函数，也就是使用new这个关键字来实例化对象的时候自动调用构造方法。构 造函数的声明与其它操作的声明一样，只是其名称必须是\_\_construct\( \)。这是PHP5中的变化，以前的版本中，构造函数的名称必须与类名相同，这种在PHP5中仍然可以用，但现在以经很少有人用了，这样做的好处是可以使构 造函数独立于类名，当类名发生改变时不需要改相应的构造函数名称了。为了向下兼容，如果一个类中没有名为\_\_construct\( \)的方法，PHP将搜索一个php4中的写法，与类名相同名的构造方法。

格式：function \_\_construct \( \[参数\] \) { ... ... }

在一个类中只能声明一个构造方法，而是只有在每次创建对象的时候都会去调用一次构造方法，不能主动的调用这个方法，所以通常用它执行一些有用的初始化任务。比如对成属性在创建对象的时候赋初值。

```php
<?php
// 创建一个人类
class Person {
    // 下面是人的成员属性
    var $name;  // 人的名子
    var $sex;   // 人的性别
    var $age;   // 人的年龄

    // 定义一个构造方法参数为姓名$name、性别$sex和年龄$age
    function __construct($name, $sex, $age) {
        // 通过构造方法传进来的$name给成员属性$this->name赋初使值
        $this->name = $name;

        // 通过构造方法传进来的$sex给成员属性$this->sex赋初使值
        $this->sex = $sex;

        // 通过构造方法传进来的$age给成员属性$this->age赋初使值
        $this->age = $age;
    }

    // 这个人的说话方法
    function say() {
        echo "我的名子叫：" . $this->name . " 性别：" . $this->sex . " 我的年龄是：" . $this->age;
    }
}

// 通过构造方法创建3个对象$p1、p2、$p3,分别传入三个不同的实参为姓名、性别和年龄
$p1 = new Person("张三","男", 20);
$p2 = new Person("李四","女", 30);
$p3 = new Person("王五","男", 40);

// 下面访问$p1对象中的说话方法
$p1->say();

// 下面访问$p2对象中的说话方法
$p2->say();

// 下面访问$p3对象中的说话方法
$p3->say();
?>
```

输出结果为：

```
我的名子叫：张三 性别：男 我的年龄是：20我的名子叫：李四 性别：女 我的年龄是：30我的名子叫：王五 性别：男 我的年龄是：40
```

如图：

![](http://images2015.cnblogs.com/blog/381128/201607/381128-20160717213351107-634868011.png)



#### **析构方法：**

与构造函数相对的就是析构函数。析构函数是PHP5新添加的内容，在PHP4中没有析构函数。 析构函数允许在销毁一个类之前执行的一些操作或完成一些功能，比如说关闭文件， 释放结果集等，析构函数会在到某个对象的所有引用都被删除或者当对象被显式销毁时执行，也就是对象在内存中被销毁前调用析构函数。与构造函数的名称类似， 一个类的析构函数名称必须是\_\_destruct\( \)。

**析构函数不能带有任何参数。**

格式：function \_\_destruct \( \) { ... ... }

```php
<?php
// 创建一个人类
class Person {
    // 下面是人的成员属性
    var $name;  // 人的名子
    var $sex;   // 人的性别
    var $age;   // 人的年龄
 
    // 定义一个构造方法参数为姓名$name、性别$sex和年龄$age
    function __construct($name, $sex, $age) {
        // 通过构造方法传进来的$name给成员属性$this->name赋初使值
        $this->name = $name;
         
        // 通过构造方法传进来的$sex给成员属性$this->sex赋初使值
        $this->sex = $sex;
         
        // 通过构造方法传进来的$age给成员属性$this->age赋初使值
        $this->age = $age;
    }
 
    // 这个人的说话方法
    function say() {
        echo "我的名子叫：" . $this->name . " 性别：" . $this->sex . " 我的年龄是：" . $this->age;
    }
 
    // 这是一个析构函数,在对象销毁前调用
    function __destruct() {
        echo "再见" . $this->name;
    }
}
 
// 通过构造方法创建3个对象$p1、p2、$p3,分别传入三个不同的实参为姓名、性别和年龄
$p1 = new Person("张三", "男", 20);
$p2 = new Person("李四", "女", 30);
$p3 = new Person("王五", "男", 40);
 
// 下面访问$p1对象中的说话方法
$p1->say();
 
// 下面访问$p2对象中的说话方法
$p2->say();
 
// 下面访问$p3对象中的说话方法
$p3->say();
?>
```

输出结果为：

```
我的名子叫：张三 性别：男 我的年龄是：20我的名子叫：李四 性别：女 我的年龄是：30我的名子叫：王五 性别：男 我的年龄是：40
再见王五
再见李四
再见张三
```

**注意：**

由于类实例是以堆栈的形式放在内存中，所以最后调用析构函数的时候，输出顺序是按后进先出的原则！

